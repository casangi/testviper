[[38;2;128;05;128m2025-08-06 20:10:44,167[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Module path: [38;2;50;50;205m/home/runner/work/testviper/testviper/src/toolviper[0m 
[[38;2;128;05;128m2025-08-06 20:10:44,169[0m] [38;2;255;160;0m WARNING[0m[38;2;112;128;144m    viperlog: [0m It is recommended that the local cache directory be set using the [38;2;50;50;205mdask_local_dir[0m parameter. 
[[38;2;128;05;128m2025-08-06 20:10:44,175[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Client <MenrvaClient: 'tcp://127.0.0.1:43429' processes=2 threads=2, memory=5.59 GiB> 
[[38;2;128;05;128m2025-08-06 20:10:44,175[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Downloading from [cloudflare] .... 
                                              
  Download List                               
 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 
  ngEHT_E17A10.0.bin0000.source0000_split.ms  
                                              
[[38;2;128;05;128m2025-08-06 20:10:44,186[0m] [38;2;220;20;60m   ERROR[0m[38;2;112;128;144m    viperlog: [0m [[38;2;220;20;60mdownload[0m]: Requested file not found: ngEHT_E17A10.0.bin0000.source0000_split.ms
[[38;2;128;05;128m2025-08-06 20:10:44,186[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m For a list of available files try using [38;2;50;50;205mtoolviper.utils.data.list_files()[0m. 

[[38;2;128;05;128m2025-08-06 20:10:44,187[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Trying to retrieve missing files dropbox: ['ngEHT_E17A10.0.bin0000.source0000_split.ms'] 
[[38;2;128;05;128m2025-08-06 20:10:44,187[0m] [38;2;255;160;0m WARNING[0m[38;2;112;128;144m    viperlog: [0m File exists: [38;2;50;50;205m/home/runner/work/testviper/testviper/src/toolviper/src/toolviper/utils/data/.dropbox[0m 
[[38;2;128;05;128m2025-08-06 20:10:44,187[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Updating file metadata information ...  
                                               
  Download List                               
 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 
  ngEHT_E17A10.0.bin0000.source0000_split.ms  
                                              
 [[38;2;128;05;128m2025-08-06 20:10:46,327[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Partition scheme that will be used: ['DATA_DESC_ID', 'OBSERVATION_ID'] 
Output file:  /tmp/test/ngEHT_E17A10.0.bin0000.source0000_split.ps.zarr
[[38;2;128;05;128m2025-08-06 20:10:46,370[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Partition scheme that will be used: ['DATA_DESC_ID', 'OBSERVATION_ID'] 
[[38;2;128;05;128m2025-08-06 20:10:46,375[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Number of partitions: 2 
[[38;2;128;05;128m2025-08-06 20:10:46,375[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m OBSERVATION_ID [0], DDI [0], STATE [-1], FIELD [0], SCAN [0] 
[[38;2;128;05;128m2025-08-06 20:10:46,547[0m] [38;2;255;160;0m WARNING[0m[38;2;112;128;144m    viperlog: [0m Source_id is -1. No source information will be included in the field_and_source_xds. 
[[38;2;128;05;128m2025-08-06 20:10:46,621[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m OBSERVATION_ID [0], DDI [1], STATE [-1], FIELD [0], SCAN [0] 
[[38;2;128;05;128m2025-08-06 20:10:46,788[0m] [38;2;255;160;0m WARNING[0m[38;2;112;128;144m    viperlog: [0m Source_id is -1. No source information will be included in the field_and_source_xds. 
Opening Processing Set, /tmp/test/ngEHT_E17A10.0.bin0000.source0000_split.ps.zarr
sum 64306946000.0 64306946000.0
Time to check datasets (all MSv4s) against schema: 0.0113372802734375
[[38;2;128;05;128m2025-08-06 20:10:47,428[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Downloading from [cloudflare] .... 
                                              
  Download List                               
 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 
  ngEHT_E17A10.0.bin0000.source0000_split.ms  
                                              
[[38;2;128;05;128m2025-08-06 20:10:47,429[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m File exists: /tmp/test/ngEHT_E17A10.0.bin0000.source0000_split.ms 

[[38;2;128;05;128m2025-08-06 20:10:47,449[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Partition scheme that will be used: ['DATA_DESC_ID', 'OBSERVATION_ID', 'FIELD_ID'] 
Output file:  /tmp/test/ngEHT_E17A10.0.bin0000.source0000_split.ps.zarr
[[38;2;128;05;128m2025-08-06 20:10:47,490[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Partition scheme that will be used: ['DATA_DESC_ID', 'OBSERVATION_ID', 'FIELD_ID'] 
[[38;2;128;05;128m2025-08-06 20:10:47,497[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m Number of partitions: 2 
[[38;2;128;05;128m2025-08-06 20:10:47,497[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m OBSERVATION_ID [0], DDI [0], STATE [-1], FIELD [0], SCAN [0] 
[[38;2;128;05;128m2025-08-06 20:10:47,667[0m] [38;2;255;160;0m WARNING[0m[38;2;112;128;144m    viperlog: [0m Source_id is -1. No source information will be included in the field_and_source_xds. 
[[38;2;128;05;128m2025-08-06 20:10:47,743[0m] [38;2;50;50;205m    INFO[0m[38;2;112;128;144m    viperlog: [0m OBSERVATION_ID [0], DDI [1], STATE [-1], FIELD [0], SCAN [0] 
[[38;2;128;05;128m2025-08-06 20:10:47,921[0m] [38;2;255;160;0m WARNING[0m[38;2;112;128;144m    viperlog: [0m Source_id is -1. No source information will be included in the field_and_source_xds. 
Opening Processing Set, /tmp/test/ngEHT_E17A10.0.bin0000.source0000_split.ps.zarr
sum 64306946000.0 64306946000.0
Time to check datasets (all MSv4s) against schema: 0.011394739151000977
Time taken in test: 4.574214935302734
